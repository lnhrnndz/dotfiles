#!/bin/sh

if [ -n "$1" ]; then
    if [ -d "$1" ]; then
        alias git='git --git-dir "${1}/.git" --work-tree "${1}/"'
    else
        echo "$1 not found"
        exit 1
    fi
fi

CHANGES=$(git status --porcelain)

if [ -n "$CHANGES" ]; then

    git add --all
    git commit -m "Automated sync
$CHANGES"
    git pull --rebase
    git push

else
    git pull --rebase
fi
