#!/bin/sh

setxkbmap -option caps:ctrl_modifier
xset r rate 200 36

OPTIONS="\
us
ch"

n=$(echo "$OPTIONS" | wc -l)

if [ -z "$1" ]; then
    #n="$(echo "$OPTIONS" | tr -d ' ' | wc -w)"

    CHOICE=$(echo "$OPTIONS" | rofi -dmenu -l "$n" -p "Select layout")

    [ -z "$CHOICE" ] && exit 1

elif [ "$1" = "next" ]; then
    CURRENT=$(setxkbmap -query | awk '/layout/{print $2}')
    exit
else
    echo "$OPTIONS" | grep -q "$1" || exit 2
    CHOICE="$1"
fi

setxkbmap "$CHOICE"

dunstify -a keyboard -u low -r 666 "keyboard layout set to $CHOICE"
